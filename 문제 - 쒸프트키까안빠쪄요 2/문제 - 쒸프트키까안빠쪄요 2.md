# 쒸프트키까안빠쪄요 2
## Time Limit: 5 seconds, Memory Limit: 1024 MB

Brainf\*\*k은 Urban Müller가 1993년에 개발한 ‘난해한 프로그래밍 언어’이다. 이 언어는 모든 값이 0으로 초기화되어 있는 배열과 그 배열의 첫 번째 주소를 가리키는 포인터, 이들을 조작하는 8개의 명령어로 이루어져 있는데, Brainf\*\*k으로 작성된 프로그램은 각 명령어를 왼쪽에서 오른쪽으로 순서대로 실행하며 동작한다.

이 문제에서는 다음 6개 명령어만을 이용한다.

프로그램의 배열을 $M$, 현재 포인터가 가리키고 있는 인덱스를 $X$로 정의하면, 각 명령어의 기능은 아래와 같다.

* `+` : $M_X = (M_X + 1)\space \mathrm{mod} \space 256$을 적용한다.
* `-` : $M_X = (M_X - 1 + 256)\space\mathrm{mod}\space256$을 적용한다.
* `[` : $M_X = 0$이라면 대응하는 `]`로 이동한다.
* `]` : $M_X \neq 0$이라면 대응하는 `[`로 이동한다.
* `,` : 문자 하나를 읽는다. 읽은 문자의 ASCII 코드 값을 $C$라 할 때, $M_X = C$를 적용한다.
  * 이 문제에서는 문자 대신 정수 $C$를 입력받아 $M_X = C$를 적용하는 명령어로 대체한다.
* `.` : ASCII 코드 값이 $M_X$인 문자를 출력한다.
  * 이 문제에서는 $M_X$의 값을 정수로 출력하는 명령어로 대체한다.

`+`, `-`, `[`. `]`로만 이루어져 있는 길이가 $N$인 문자열 $A = A_1, A_2, ..., A_N$ 이 주어진다. 이때, 다음 쿼리를 수행하는 프로그램을 작성하시오.

* `1 L R`: $A$의 부분 문자열 $A_{L, R} = A_L, A_{L+1}, ..., A_{R-1}, A_R$ 에 대해, 다음을 수행한다.
  * $A_{L, R}$에 `[` 또는 `]`이 포함되어 있다면, 이 쿼리를 무시한다.
  * $A_{L, R}$에 `[` 또는 `]`이 포함되어 있지 않다면, $A_{L, R}$에 포함된 모든 `+` 명령어를 `-`로, `-` 명령어를 `+`로 변경한다.

* `2 L R K`: $A$의 부분 문자열 $A_{L, R} = A_L, A_{L+1}, ..., A_{R-1}, A_R$ 에 대해, $A_{L, R}$을 하나의 Brainf\*\*k 프로그램으로 간주한다.
    
    $A_{L, R}$이 실행 가능하다면, $A_{L, R}$이 실행되면서 사용된 명령어의 수가 $K$보다 작다면 `YES`를, 그렇지 않다면 `NO`를 출력한다.

    만약 $A_{L, R}$이 실행 가능하지 않다면 `ROCK`을 출력한다.

    * $A_{L, R}$이 실행 가능하다는 것은, $A_{L, R}$에 포함된 모든 `[` 명령어와 `]` 명령어에 각각 대응하는 쌍이 존재함을 의미한다.

* `3 L R K`: $A$의 부분 문자열 $A_{L, R} = A_L, A_{L+1}, ..., A_{R-1}, A_R$ 에 대해, $A_{L, R}$을 하나의 Brainf\*\*k 프로그램으로 간주한다.

    $A_{L, R}$의 맨 앞에 `,` 명령어를 추가하고, $A_{L, R}$의 맨 뒤에 `.` 명령어를 추가한다. 이후, $A_{L, R}$이 실행 가능하다면, $A_{L, R}$에 입력으로 $K$가 주어졌을 때 $A_{L, R}$의 실행 결과를 출력한다.

    만약 $A_{L, R}$이 무한 루프에 빠지거나, $A_{L, R}$이 실행 가능하지 않다면 `ROCK`을 출력한다.

2번, 3번 쿼리가 주어질 때마다 $A_{L, R}$ 은 독립적인 환경에서 실행된다. 즉, 각각의 $A_{L, R}$ 은 배열의 모든 값이 0으로 초기화되어 있고, 포인터가 배열의 첫 번째 주소를 가리키고 있는 상황에서 실행된다.

2번, 3번 쿼리는 한 번 이상 주어진다.

## 입력
첫째 줄에 $N$이 주어진다. ($1 \leq N \leq 1,000,000$)

둘째 줄에는 $A$가 주어진다.

셋째 줄에는 쿼리의 개수 $Q$가 주어진다. ($1 \leq Q \leq 300,000$)

넷째 줄부터 $Q$개의 줄에는 쿼리가 한 줄에 하나씩 주어진다.

1번 쿼리의 경우 $1 \leq L < R \leq N$을 만족한다.

2번 쿼리의 경우 $1 \leq L \leq R \leq N$, $1 \leq K \leq 10^{18}$을 만족한다.

3번 쿼리의 경우 $1 \leq L \leq R \leq N$, $0 \leq K \leq 255$을 만족한다.

## 출력
2번, 3번 쿼리가 주어질 때마다 정답을 한 줄에 하나씩 출력한다.